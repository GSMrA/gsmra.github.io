<!DOCTYPE html>
<html lang="fr">
<head>
  <title>Mon Compte - GeekSoft</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/png" href="GEEKSOFT.png">
  <style>
    :root{
      --black:#000;
      --white:#fff;
      --muted:#666;
      --glow:#ffffff;
      --gray-bg:#1e1e1e;
      --max-width:1100px;
    }
    html,body{
      height:100%;
      margin:0;
      font-family:'Arial Black', Impact, sans-serif;
      background:var(--gray-bg);
      color:#fff;
    }
    @keyframes slideDown {
      from { opacity:0; transform:translateX(-50%) translateY(-100px);}
      to   { opacity:1; transform:translateX(-50%) translateY(0);}
    }
    @keyframes fadeInUp {
      from { opacity:0; transform:translateY(30px);}
      to   { opacity:1; transform:translateY(0);}
    }
    @keyframes fadeIn {
      from { opacity:0;}
      to   { opacity:1;}
    }
    .topbar{
      position:fixed;
      top:20px;
      left:50%;
      transform:translateX(-50%);
      background:var(--black);
      color:var(--white);
      padding:28px 40px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow:0 0 30px var(--glow), 0 8px 20px rgba(255,255,255,0.2);
      border-radius:24px;
      width:90%;
      max-width:1300px;
      z-index:1000;
      animation: slideDown 0.8s cubic-bezier(.44,1.3,.44,1) forwards;
    }
    .logo{
      height:70px;
      width:auto;
      display:block;
      filter:drop-shadow(0 0 15px var(--glow));
    }
    .title{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      font-weight:900;
      font-size:3.5rem;
      letter-spacing:3px;
      text-transform:uppercase;
      color:var(--white);
      text-shadow:0 0 15px var(--glow), 0 0 30px var(--glow);
    }
    .account-container{
      margin-top: 160px;
      max-width: 440px;
      padding: 32px 24px 24px 24px;
      background: #242424;
      border-radius: 16px;
      box-shadow: 0 6px 30px #000a;
      text-align: center;
      margin-left: auto;
      margin-right: auto;
      animation: fadeInUp 1s cubic-bezier(.44,1.3,.44,1) 0.2s both;
    }
    h1 {
      font-size: 2.1rem;
      margin-bottom: 20px;
      text-shadow: 0 2px 12px #fff1;
      animation: fadeIn 0.75s cubic-bezier(.44,1.3,.44,1) 0.4s both;
    }
    .avatar {
      width:80px;
      height:80px;
      border-radius:50%;
      margin-bottom:18px;
      box-shadow: 0 2px 8px #0005;
      object-fit:cover;
      display:block;
      margin-left:auto;
      margin-right:auto;
      animation: fadeIn 0.8s cubic-bezier(.44,1.3,.44,1) 0.4s both;
    }
    .info-label {
      font-weight:bold;
      color: #47c5ff;
      margin-right:7px;
      font-size:16px;
      display: inline-block;
    }
    .info-line {
      margin-bottom:18px;
      font-size: 17px;
      animation: fadeInUp 1s cubic-bezier(.44,1.3,.44,1) 0.7s both;
      text-align:left;
    }
    .guild-section {
      margin-top:26px;
      background: #222;
      border-radius: 12px;
      padding: 11px 11px;
      box-shadow: 0 2px 7px #0006;
      animation: fadeInUp 1s cubic-bezier(.44,1.3,.44,1) 0.9s both;
    }
    .guild-name {
      font-size:18px;
      color:#ffae34;
      font-weight:bold;
      margin-bottom:8px;
    }
    .back-link {
      color: #888;
      display:inline-block;
      margin-top:26px;
      text-decoration:none;
      font-size: 15px;
      transition: color 0.2s;
      animation: fadeInUp 1s cubic-bezier(.44,1.3,.44,1) 1s both;
    }
    .back-link:hover {
      color: #47c5ff;
    }
    @media (max-width:480px){
      .logo{height:45px}
      .title{font-size:2rem;}
      .topbar{padding:16px;width:95%;border-radius:16px;}
      .account-container{max-width:98vw;}
      .info-label,.info-line{font-size:14px;}
      .guild-name{font-size:15px;}
    }
  </style>
</head>
<body>
  <header class="topbar">
    <img src="GEEKSOFT.png" alt="GEEKSOFT" class="logo" />
    <div class="title">GEEKSOFT</div>
  </header>
  <div class="account-container">
    <h1>Mon compte Discord</h1>
    <img class="avatar" src="https://cdn.discordapp.com/embed/avatars/1.png" id="avatar" alt="Avatar Discord" />
    <div class="info-line"><span class="info-label">Pseudo :</span><span id="username">User#1234</span></div>
    <div class="info-line"><span class="info-label">ID :</span><span id="discordid">00000000000000000</span></div>
    <div class="info-line"><span class="info-label">Date d'inscription :</span><span id="creationdate">01/01/2020</span></div>
    <div class="guild-section">
      <div class="guild-name">Serveur GeekSoft (ID : 1419335118614696042)</div>
      <div class="info-line"><span class="info-label">Rang & Rôle :</span><span id="role">Membre</span></div>
      <div class="info-line"><span class="info-label">Date de join :</span><span id="joindate">05/05/2021</span></div>
      <div class="info-line"><span class="info-label">Activité :</span><span id="activity">15 messages ce mois-ci</span></div>
    </div>
    <div class="guild-section" style="margin-top:14px;">
      <div class="info-line"><span class="info-label">Autres infos :</span><span id="other">Prêt à intégrer d’autres stats à partir de l’API Discord…</span></div>
    </div>
    <a class="back-link" href="index.html">Retour à l'accueil</a>
  </div>
  <script>
    // Fonction utilitaire pour extraire les paramètres URL
    function getParameterByName(name) {
      name = name.replace(/[\\[\\]]/g, "\\\\$&");
      const url = window.location.href;
      const regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\\+/g, " "));
    }

    const usernameToQuery = getParameterByName('user');
    if (!usernameToQuery) {
      alert("Aucun nom d'utilisateur fourni en paramètre.");
    } else {
      // Construire l'URL de l'API Flask (adaptée à ton URL Replit publique)
      const apiURL = `https://84d0c0cc-e56b-43d5-b6ad-7a550cf6d811-00-yuo4uk60khmn.picard.replit.dev:8080/ueserinfo?user=${encodeURIComponent(usernameToQuery)}`;

      fetch(apiURL)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            alert("Erreur API: " + data.error);
            return;
          }
          // Mettre à jour les éléments du DOM
          document.getElementById('username').textContent = data.username;
          document.getElementById('discordid').textContent = data.id;
          document.getElementById('avatar').src = data.avatar_url || "https://cdn.discordapp.com/embed/avatars/1.png";
          // Exemple, la date de création n'est pas dans la réponse, donc texte fixe
          document.getElementById('creationdate').textContent = "(Date non disponible)";
          document.getElementById('role').textContent = data.roles.length > 0 ? data.roles.join(", ") : "Membre";
          document.getElementById('joindate').textContent = data.joined_at ? new Date(data.joined_at).toLocaleDateString() : "Non disponible";
          document.getElementById('activity').textContent = "(À implémenter)";
          document.getElementById('other').textContent = "(Autres stats à venir)";
        })
        .catch(err => {
          alert("Erreur lors de la récupération des données.");
          console.error(err);
        });
    }
  </script>
</body>
</html>
