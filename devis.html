<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GeekSoft - Envoi Devis</title>
  <link rel="icon" type="image/png" href="GEEKSOFT.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --background: #0b0b0b;
      --text-main: #ffffff;
      --muted: #cccccc;
      --accent: #ffffff;
      --card-bg: #141414;
      --shadow: 0 0 25px rgba(255,255,255,0.2);
    }
    html, body {
      margin:0; font-family:'Poppins',sans-serif;
      background:var(--background); color:var(--text-main);
      display:flex; flex-direction:column; align-items:center;
      min-height:100vh; overflow-x:hidden;
    }
    .topbar {
      position:fixed; top:20px; left:50%;
      transform:translateX(-50%);
      background:#000; color:var(--text-main);
      padding:20px 30px; display:flex; align-items:center;
      justify-content:space-between; border-radius:18px;
      width:90%; max-width:900px;
      box-shadow:0 0 20px rgba(255,255,255,0.4); z-index:100;
    }
    .logo {height:55px; filter:drop-shadow(0 0 8px var(--accent));}
    .title {font-weight:700; font-size:2rem; letter-spacing:1.5px; text-transform:uppercase; color:var(--text-main); text-shadow:0 0 15px rgba(255,255,255,0.6); margin:0;}
    .spacer {height:120px;}
    .card {
      background:var(--card-bg); border-radius:20px;
      padding:30px; width:90%; max-width:900px;
      box-shadow:var(--shadow); margin-bottom:60px;
      overflow:hidden; position:relative;
    }
    form .row{display:flex;gap:12px;margin-bottom:12px}
    label{display:block;font-size:0.9rem;margin-bottom:6px;color:var(--muted)}
    input[type="text"],input[type="email"],select,textarea{
      width:100%;padding:10px;border-radius:8px;
      border:1px solid rgba(255,255,255,0.06);
      background:#0f0f0f;color:var(--text-main)
    }
    textarea{min-height:90px;resize:vertical}
    .btn{display:inline-block;padding:12px 18px;
      border-radius:12px;background:var(--accent);
      color:#000;font-weight:600;border:none;cursor:pointer}
    .muted{color:var(--muted);font-size:0.9rem;margin-top:8px}
    .confirm{padding:20px;text-align:center}
    .loader {
      width: 35px; aspect-ratio: 1;
      --_g: no-repeat radial-gradient(farthest-side,#000 94%,#0000);
      background:var(--_g) 0 0, var(--_g) 100% 0,
                 var(--_g) 100% 100%,var(--_g) 0 100%;
      background-size: 40% 40%;
      animation: l38 .5s infinite;
      margin: auto;
    }
    @keyframes l38 { 100% {background-position: 100% 0,100% 100%,0 100%,0 0} }
    .loader-overlay {
      position: absolute; inset: 0;
      background: rgba(0,0,0,0.6);
      display: flex; align-items: center; justify-content: center;
      z-index: 200; border-radius: 20px; display:none;
    }
    #recap{margin-left:0;text-align:left;white-space:pre-wrap;}
    @media (max-width:900px){
      .panel{width:100%}
    }
  </style>
</head>
<body>
  <header class="topbar">
    <img src="GEEKSOFT.png" alt="GEEKSOFT" class="logo" />
    <div class="title">GEEKSOFT - DEVIS</div>
  </header>
  <div class="spacer"></div>
  <div class="card" id="card">
    <div class="loader-overlay" id="loader-overlay"><div class="loader"></div></div>
    <div id="form-panel">
      <h2>Envoyer un devis</h2>
      <p class="muted">Remplis tes infos et décris le bot voulu.<br><a href="mentions_légales.html" target="_blank" rel="noopener noreferrer">Mentions légales</a>
</p>
      <form id="quote-form">
        <div class="row">
          <div style="flex:1">
            <label for="firstname">Prénom</label>
            <input id="firstname" name="firstname" type="text" required />
          </div>
          <div style="flex:1">
            <label for="lastname">Nom</label>
            <input id="lastname" name="lastname" type="text" required />
          </div>
        </div>
        <div class="row">
          <div style="flex:1">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" required />
          </div>
          <div style="flex:1">
            <label for="botname">Nom du bot</label>
            <input id="botname" name="botname" type="text" placeholder="Ex : MonSuperBot" required />
          </div>
        </div>
        <div class="row">
          <div style="flex:1">
            <label for="members">Nombre de membres</label>
            <select id="members" name="members">
              <option value="0-100">0 - 100</option>
              <option value="101-500">101 - 500</option>
              <option value="501-2000">501 - 2000</option>
              <option value="2001+">2001+</option>
            </select>
          </div>
        </div>
        <label for="features">Fonctionnalités demandées</label>
        <textarea id="features" name="features" placeholder="Ex : commandes modération, XP, tickets..."></textarea>
        <div style="display:flex;gap:12px;margin-top:18px;align-items:center">
          <button type="submit" class="btn" id="send-quote">Envoyer mon devis</button>
          <div class="muted" id="status-note"></div>
        </div>
      </form>
    </div>
    <div id="confirmation" style="display:none" class="confirm">
      <h2>Devis envoyé ✅</h2>
      <p>Merci — nous avons bien reçu ta demande. Tu recevras une réponse par e-mail rapidement.</p>
      <p class="muted">Si problème, contacte-nous.</p>
    </div>
  </div>
  <script>
    const loader = document.getElementById('loader-overlay');
    const form = document.getElementById('quote-form');
    const confirmation = document.getElementById('confirmation');
    const formPanel = document.getElementById('form-panel');
    function showLoader(){ loader.style.display='flex'; }
    function hideLoader(){ loader.style.display='none'; }
    form.addEventListener('submit', async function(e){
      e.preventDefault();
      showLoader();
      const data = new FormData(form);
      // Structure le JSON comme demandé dans la capture d’écran
      const payload = {
        "prenom": data.get('firstname'),
        "nom": data.get('lastname'),
        "email": data.get('email'),
        "nom_bot": data.get('botname'),
        "nombre_membres": data.get('members'),
        "fonctionnalites": data.get('features')
      };
      try {
        await fetch('https://devmra.pythonanywhere.com/devisadd', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });
        formPanel.style.display = 'none';
        confirmation.style.display = 'block';
      } catch (err){
        document.getElementById('status-note').textContent = "Erreur lors de l'envoi, réessaye dans quelques minutes.";
      }
      hideLoader();
    });
  </script>
</body>
</html>
